# How-To Tableau

[`Tableau 도움말`](https://help.tableau.com/current/pro/desktop/ko-kr/datafields_typesandroles_datatypes.htm)  
[`youtube - DK BMC`](https://www.youtube.com/@DKBMCOfficial)  

### 환경

- version : Tableau Desktop 2024.01 ver

- **데이터 연결방식**
1. 라이브 : 데이터 원본 실시간 동기화 (원본 수정시 실시간 반영)
2. 추출 : Hyper 형태로 복사본 불러옴 (처리속도 빠름o)

- **데이터 유형**
1. ![image](https://github.com/Choe-minsung/TIL/assets/145301343/b99c3734-9f94-441e-84ba-bce3e58e80d9) : 텍스트
2. ![image](https://github.com/Choe-minsung/TIL/assets/145301343/98cc2f2e-8918-4559-8e35-b65679506065) : 날짜(달력)
3. ![image](https://github.com/Choe-minsung/TIL/assets/145301343/ca44b6aa-ffe4-4c7c-bf83-0f31a5fb63ab) : 날짜+시간
4. ![image](https://github.com/Choe-minsung/TIL/assets/145301343/e1330c23-48a7-4131-9a09-62a53c6451ff) : 숫자
5. ![image](https://github.com/Choe-minsung/TIL/assets/145301343/22d66edd-d6c1-44af-8745-6bdf5bd2e114) : boolean
6. ![image](https://github.com/Choe-minsung/TIL/assets/145301343/c86026ae-370d-4600-8468-a03e8277cf2c) : map

- **데이터 형태**
1. 범주값 : 열에 사용
2. 수치값 (측정값) : 행으로 사용 (집계, 평균 등) 
<img width="150" alt="image" src="https://github.com/Choe-minsung/TIL/assets/145301343/eb922ae6-26f1-4fa3-84c6-7a7f58f43462">

3. 날짜컬럼의 **불연속형(파란색)** : '월'을 범주값으로 보고 통합하여 계산, 날짜컬럼 우클릭 시 위쪽
<img width="450" alt="image" src="https://github.com/Choe-minsung/TIL/assets/145301343/cef89fd5-c136-4e09-be7f-79f08aad1679">

4. 날짜컬럼의 **연속형(초록색)** : **병렬차트**에 필수작업! 모든 '월'을 각각 계산, 날짜컬럼 우클릭 시 아래쪽
<img width="450" alt="image" src="https://github.com/Choe-minsung/TIL/assets/145301343/b980488c-2970-4df4-a114-86da25f1c391">

---

- **데이터 표시**  
1. **그룹** : 데이터들을 묶어 그룹 별 시각화o  
   1-1. 차트에서 직접 그룹핑하고싶은 데이터들을 드래그해서 우클릭 - **'그룹'** - 반복하여 여러 그룹 생성  
   1-2. 그룹화 할 컬럼 우클릭 후 **'만들기-그룹'** - 원하는 데이터들 shift 다중선택으로 그룹핑 - 새로 생성된 그룹컬럼을 **'열'**, **'마크-색상'** 에 드랍 - '열'의 그룹컬럼 우클릭 **'필터'** 를 통해 원하는 데이터만 선택하여 시각화  
2. **계층** : 컬럼들을 묶어 **드릴다운**으로 펼칠 수 있게 함   
   <img width="300" alt="image" src="https://github.com/Choe-minsung/TIL/assets/145301343/604d1caa-4942-4d87-b8fd-8f7ac7f68ebc">  
3. **집합** : 집합화 할 컬럼 우클릭 후 **'만들기-집합'** - 원하는 조건에 따라 집합 - 새로 생성된 집합컬럼을 **'마크-색상'** 에 드랍 - 내림차순 및 범례 색상 조절  
  <img width="300" alt="image" src="https://github.com/Choe-minsung/TIL/assets/145301343/76149f64-308a-4060-96af-21799398f683">

4. **결합된 집합** : 생성 된 두 집합 간 **Union(intersect, except, full) 관계**에 해당하는 데이터 추출o

   - *시/도 별 매출이 5만원 이상이면서 수익률이 10% 이상인 데이터만 추출*
   
   4-1. (시/도) 컬럼 우클릭 후 **'만들기-집합'** - **'조건'** 탭에서 '필드기준-매출 합계 >= 50000' 생성
   
   4-2. (시/도) 컬럼 우클릭 후 **'만들기-집합'** - **'조건'** 탭에서 '필드기준-수익 합계 >= 0.1' 생성
   
   4-3. 생성 된 둘 중 아무 집합 우클릭 후 **'결합된 집합 만들기'** - 두 집합 선택 후 **'두 집합의 공유 멤버'** 선택 후 확인  
   
   <img width="300" alt="image" src="https://github.com/Choe-minsung/TIL/assets/145301343/f26a426d-bd09-4480-af58-53baff8d4ee6">  
   
   4-4. '행'에 (시/도), '마크-색상'에 **결합된 집합 드랍**, '마크-레이블'에 (매출), (수익) 드랍 - 내림차순 정렬  
   
   <img width="450" alt="image" src="https://github.com/Choe-minsung/TIL/assets/145301343/dc025080-d1ec-4962-a0f8-734b2ff20653">

5. **계산된 필드** : 컬럼 우클릭 후 **계산식을 작성**하여 계산 된 필드 생성  
   5-1. (수익률) 계산 필드 생성 : (수익) 컬럼 우클릭 - 생성할 필드 명 '수익률' 작성 - 계산식에 **'SUM([수익]) / SUM([매출])'** 입력  
   5-2. 생성 된 (수익률) 컬럼 우클릭 후 **'기본속성-숫자형식-백분율'** 설정  
   <img width="450" alt="image" src="https://github.com/Choe-minsung/TIL/assets/145301343/1192c674-c018-4dd5-a9e5-e59948506466">   

   - 계산된 필드 실습  
   1. *(고객 이름) 을 Last name(성) First name(이름) 으로 분리*    
   1-1. (고객 이름) 우클릭 후 **'만들기-계산된 필드'** - 고객 이름(성) 은 계산식 **'SPLIT(['고객 이름'], ' ', 1)'** - 고객 이름(이름) 은 계산식 **'SPLIT([고객 이름], ' ', 2)'** 입력  
   1-2. '열' 에 둘 다 올려 확인  
    
      
   2. *(수익)을 범위에 따라 '수익성 있음', '수익성 없음', '손익평형' 으로 분류*   
   2-1. (수익) 컬럼 우클릭 후 **'만들기-계산된 필드'** - 필드명 (수익성) 입력, 계산식 입력  
   
```
IF [수익] > 0 THEN '수익성 있음'
ELSEIF [수익] < 0 THEN '수익성 없음'
ELSE '손익평형'
END
```
   

   2-2. '행'에 (제품 id), (수익성), '마크-레이블'에 (수익) 올려 확인  

   3. *(주문 날짜)와 (배송 날짜)의 날짜 차이를 이용하여 (배송 기간) 필드 생성*  
   3-1. (주문 날짜) 컬럼 우클릭 후 **'만들기-계산된 필드'** - 필드명 (배송 기간) 입력, 계산식 **'DATEDIFF('day', [주문 날짜], [배송 날짜])'** 입력    
   3-2. '행'에 (주문 id), (주문 날짜), (배송 날짜) 올리기 - 올라간 (주문 날짜)와 (배송 날짜) 우클릭하여 불연속 데이터 형태의 '더보기' 클릭 - **'연도/월/일'** 로 변경   
   <img width="300" alt="image" src="https://github.com/Choe-minsung/TIL/assets/145301343/501a937b-dc76-4d65-ad03-29c6c51c4bdf">

   3-3. 만든 계산필드 (배송 기간)이 주문 id 별 모든 주문 건 수를 합계한 '측정값'이기 때문에 (배송 기간) 우클릭 후 **'차원으로 변환'**   
   
   <img width="450" alt="image" src="https://github.com/Choe-minsung/TIL/assets/145301343/91ba051b-0789-4997-8714-677ac99e5f03">  
 
   4. *(고유주문건수) 필드 생성하여 중복을 제거한 주문건수 합계 표시*  
   4-1. (주문 ID) 우클릭 후 **'만들기-계산된필드'** - (고유주문건수)로 필드명 작성, 계산식에 **'COUNTD([주문 ID])'** 입력 (COUNTD : 고유값 카운트)  
   4-2. '열'에 (주문날짜), '행'에 만든 계산필드 올리기  
   4-3. 차트에 2021년도 마우스오버하여 우클릭 후 **'데이터보기'**  
   <img width="414" alt="image" src="https://github.com/Choe-minsung/TIL/assets/145301343/f429d712-ac08-4121-a248-001a89c77830">

   4-4. '요약'탭의 고유주문건수는 956건, '전체데이터'탭의 행 갯수는 1929건 - 즉, **총 주문id는 1929개**인데 **고유주문id는 956건**이다. (제품 id)를 측정값(카운트) 로 바꾸어 '행'에 올려 건수 확인해보면, 1929건 출력.  
   <img width="367" alt="image" src="https://github.com/Choe-minsung/TIL/assets/145301343/b256c3b0-49e1-4e2e-803d-42761604e36b">  

   5. *(누적매출) 만들기*   
   5-1. (매출) 컬럼 우클릭 후 **'만들기-계산된필드'** - (누적매출) 필드명 작성, 계산식 **'RUNNING_SUM(SUM([매출]))'** (RUNNING_SUM(SUM()) : 누계)   
   5-2. '열'에 (주문날짜), '행'에 (주문날짜/분기), (주문날짜/월) - (매출), (누적매출)을 **'마크-레이블'** 에 올리기  
   5-3. 레이블에 올라간 (누적매출)을 우클릭 후 **'테이블 계산 편집'** - **'특정차원-주문날짜의월'** 선택 시 월을 누계하여 분기소계가 나타남.  
   <img width="447" alt="image" src="https://github.com/Choe-minsung/TIL/assets/145301343/cc59630e-12db-49b9-991a-bfb2cf6517c4">  

   6. *(전월대비 매출변동) 만들기*  
   6-1. (매출) 우클릭 후 **'만들기-계산된필드'** - (전월대비 매출변동)으로 필드명 작성, 계산식에 **'SUM([매출]) - LOOKUP(SUM([매출]), -1)'** (LOOKUP(expression, [offset]) : 몇번째 offset 이전/이후 값 찾기)  
   6-2. '행'에 (주문날짜/년), (주문날짜/월) 올리기 - **'마크-레이블'** 에 (매출), (전월대비 매출변동) 올려 확인하기  
   <img width="516" alt="image" src="https://github.com/Choe-minsung/TIL/assets/145301343/6089e096-1347-4dc2-9e23-2628042eb244">


   

---

- **필터** : 쿼리 속도향상, 용량 절약
1. **추출** : '데이터 원본' 탭에서 테이블 생성 - 우상단 탭 **'연결-추출'** 선택 후 **'편집-필터추가'** - 원하는 컬럼의 필터 적용
<img width="600" alt="image" src="https://github.com/Choe-minsung/TIL/assets/145301343/e387a21a-7c1d-4bef-ade8-dbe44da3ac41">

2. **데이터원본** : '데이터 원본' 탭에서 테이블 생성 - 우상단 탭 **'연결-라이브'** 상태에서 **'필터-추가'** - 원하는 컬럼의 필터 적용
<img width="600" alt="image" src="https://github.com/Choe-minsung/TIL/assets/145301343/4d25be6a-ebce-4654-b077-b3256c05dd43">

3. **context** (필터 간 종속성o) : **기술** 카테고리의 **매출 상위 10개 제품명 추출**   
  3-1. (범주), (제품이름), (매출)을 더블클릭 - 필터에 (제품이름) 드랍 - **'상위'** 탭에서 **'필드기준-상위 10-매출 합계'** 확인 - 필터에 다시 (범주) 드랍 - **'기술'** 카테고리만 체크 후 확인  
   <img width="450" alt="image" src="https://github.com/Choe-minsung/TIL/assets/145301343/7f0992e4-bebf-4219-971d-08f6ccec4457">  
  3-2. *기술 카테고리의 매출 상위 10개를 보고싶은데 필터가 독립적으로 작용하여 4개만 추출 됨* : 필터에 (범주: 기술) 우클릭 후 **'컨텍스트에 추가'** - 내림차순 정렬  
   <img width="450" alt="image" src="https://github.com/Choe-minsung/TIL/assets/145301343/0667a20c-3d4a-4ccf-816c-f6ca597bc488">  

4. **차원** : (제품이름) 필터에 드랍 - '일반(직접 데이터 선택)', '와일드카드(LIKE 문자열)', '조건(수식)', '상위(상위 몇개)' 탭을 이용하여 원하는 조건으로 필터링o

---

### 데이터 결합 (컬럼 추가)
- **관계** : 각각 테이블 더블클릭
1. 동일컬럼 존재시에만 결합 가능 (key 컬럼이 고유값인지 확인! 아니면 중복발생)
2. 먼저 불러온 테이블이 outer table (root table) 로 삭제시 하위 테이블 모두 삭제됨
3. 일 : 다, 다 : 다 ...

- **Join** : 1개의 테이블 더블클릭 - 열기 - 2번째 테이블 더블클릭
1. inner, left, right, outer 조인방식 설정 가능

- **혼합**
1. 시트에 union 할 2개의 테이블 불러오기 : 하단탭 데이터 원본에서 1개 테이블 더블클릭 - 하단탭 시트 1 - 상단탭 데이터 - 새 데이터원본 - 새 excel파일 불러오기 - 다시 하단탭 데이터 원본에서 새 테이블 더블클릭 - 하단탭 시트 1
<img width="150" alt="image" src="https://github.com/Choe-minsung/TIL/assets/145301343/e6e1e299-b3a8-420e-a6d1-820b8889546e">

2. 열설정, 마크(data) 설정 : 첫번째 테이블클릭 -  열로 설정할 컬럼 '열'에 드랍 - 두번째 테이블클릭 - 마크(data)로 설정할 컬럼 '마크 - 텍스트'에 드랍
<img width="450" alt="image" src="https://github.com/Choe-minsung/TIL/assets/145301343/dbf6467d-1a4b-475b-a2a8-894bdc90f07d">

### 데이터 결합 (행 추가)
- **Union** : 행 방향으로 붙이기 (컬럼명, 컬럼수 동일해야 함)
1. 1개 테이블 더블클릭 - 바로 아래 다른 테이블 드랍
2. '새 유니온' 클릭 - 2개 테이블 넣기

---



### 차트 기본
- **차트 그리기**
1. 범주컬럼 더블클릭 or '열'에 드랍
2. 수치컬럼 더블클릭 or '마크-레이블' or '행'에 드랍
3. '마크-차트종류' or '표현방식' 선택 (라인, 막대, 영역차트, 파이차트, 누적막대...)
4. 가로차트 <-> 세로차트 : 상단탭 '**행과 열 바꾸기**' 클릭

- **차트 정렬** : 수치컬럼 값에 따라 정렬
1. 상단탭 '(범주컬럼)내에서 (수치컬럼)의 (합계)별로 (오름차순 or 내림차순)정렬됨' 클릭
2. '열' 지정된 컬럼 우클릭 - '정렬' - 정렬기준 : (필드), 정렬순서 : (오름차순 or 내림차순), 필드명 : (매출), 집계 : (합계)

- **마크** : 색상, 크기, 레이블 조정
1. '마크-색상'에 원하는 컬럼 드랍 : ex) (제품카테고리)에 따른 막대 색상 조절
2. '마크-크기'에 원하는 컬럼 드랍 : ex) (매출)에 따른 막대 크기 조절
3. '마크-레이블'에 원하는 컬럼 드랍 : ex) 막대에 (제품카테고리)명 레이블, (매출)값 레이블 표시, 여러 레이블 순서('레이블'-'텍스트'-'...'), 레이블 표시 위치 (막대 위, 막대 안, 레이블방향 등)
4. 레이블을 백분율로 : '행' 컬럼 우클릭 - '퀵 테이블 계산' - **구성 비율** - '테이블 계산 편집' - **테이블(아래로)** - ctrl 누른 채 레이블에도 추가
<img width="450" alt="image" src="https://github.com/Choe-minsung/TIL/assets/145301343/aec39f47-7c4c-4dd7-bafa-42bfb8848a39">

- **이중축** : 마크를 각각의 축에 개별적으로 적용 
1. '열'에 (주문날짜), '행'에 (매출), (수익) 더블클릭으로 할당 - (주문날짜) 우클릭 후 (연속형 분기) 선택
2. '행'의 아무 필드나 우클릭 후 **'이중축'** 선택
3. 아무 축에 마우스 오버하여 우클릭 후 **'축 동기화'** 선택  
<img width="450" alt="image" src="https://github.com/Choe-minsung/TIL/assets/145301343/498c8a64-5758-46e5-be6e-e74d50742b2a">  

### 퀵 테이블 계산  
- *매출과 매출누계 라인차트 그리기*  
1. '열'에 날짜컬럼(우클릭으로 원하는 '년'or'월'or'일' 만 추출하여 드랍), '행'에 (매출) 올리기  
2. '행'에 올라간 (매출)을 ctrl + 드랍으로 하나 더 '행'에 생성 - 생성 된 (매출) 우클릭 후 **'퀵 테이블 계산-누계'** 후 다시 우클릭 후 **'이중축'** 설정  

- *지역별, 범주별 매출순위와 매출구성비율 표시*  
1. '행'에 (지역), (범주) 드랍, (매출) **'마크-레이블'** 에 드랍 - (매출) 우클릭 후 **'퀵 테이블 계산-순위'** 선택 - 다시 우클릭 후 **'다음을 사용하여 계산-패널(아래로)'** 선택  
2. (매출) 하나 더 **'마크-레이블'** 에 드랍 - (매출) 우클릭 후 **'퀵 테이블 계산-구성비율'** 선택 - 다시 우클릭 후 **'다음을 사용하여 계산-패널(아래로)'**  
3. (매출/순위) 우클릭 후 '서식-숫자(사용자지정)-소수자릿수 0' 설정  
<img width="450" alt="image" src="https://github.com/Choe-minsung/TIL/assets/145301343/0ab6e36b-b696-4ce5-9d36-46e1359c0b7d">  

- *분기별 매출, 매출이동평균 라인차트 그리기*  
1. '열'에 (주문날짜) 불연속형 분기로 드랍, '행'에 (매출) 2개 드랍 - 하나는 우클릭 **'퀵 테이블 계산-이동평균'** 선택  
2. **'이중축'**, **'축 동기화'** 설정 - 각 (매출), (매출/이동평균) 을 자기 자신 **'마크-레이블'** 에 드랍  
3. 범례의 (매출), (테이블(옆으로)기준으로 ...) 각각 더블클릭 하여 한 눈에 구분되도록 색상 지정 - 각 **'마크-레이블'** 클릭 후 **'글꼴-마크색상일치'** 클릭  
<img width="477" alt="image" src="https://github.com/Choe-minsung/TIL/assets/145301343/3ae41d9f-9e7f-4a68-8086-5c6d5baa03a3">  

- *YTD총계, YTD성장률 설정하여 년 기준 누계 표시*  
1. '행'에 (주문날짜/년), (주문날짜/월) 드랍, (매출) 더블클릭 후 우클릭 **'퀵 테이블 계산-YTD총계'** 선택   
2. 새로운 (매출) 더블클릭 후 우클릭 **'퀵 테이블 계산-YTD성장률'** 선택   
3. 새로운 (매출) 더블클릭 하여 시트에서 확인   
<img width="450" alt="image" src="https://github.com/Choe-minsung/TIL/assets/145301343/3c56a8a6-8966-42c0-94cf-ba7af6df2625">  
 

- *통합성장률(Compound Growth Rate), 전년대비성장률 설정*  
1. '행'에 (주문날짜/년), (주문날짜/월) 드랍, (매출) 더블클릭 후 우클릭 **'퀵 테이블 계산-통합성장률'** 선택  
2. 새로운 (매출) 더블클릭 후 우클릭 **'퀵 테이블 계산-전년대비성장률'** 선택  
3. 새로운 (매출) 더블클릭 하여 시트에서 확인  

<img width="450" alt="image" src="https://github.com/Choe-minsung/TIL/assets/145301343/7f550919-4211-488c-9f29-d856b4f0ff62">  


### 매개변수 
- *하위범주 별 상위 매출 N개 보기*  
1. '행'에 (하위범주), '열'에 (매출) 드랍   
2. 좌상단 '데이터' 탭에서 **'세모-매개 변수 만들기'** 클릭 - **'이름 : 상위제품범주, 데이터유형 : 정수, 현재 값 : 5'** 설정  
<img width="199" alt="image" src="https://github.com/Choe-minsung/TIL/assets/145301343/92cce6d4-dd7f-4213-8ba9-dc6e607a36de">  

3. 좌하단에 생성 된 매개변수 우클릭 후 **'매개변수표시'** 클릭 - '행'의 (하위범주) 필터로 드랍 - '상위' 탭에 **'상위-상위제품범주(만든 매개변수)-매출-합계'** 선택  
<img width="205" alt="image" src="https://github.com/Choe-minsung/TIL/assets/145301343/a09a6f30-3345-42a2-b849-72d1bd8756cf">  

4. 매개변수 숫자 바꿔면서 시트 확인  

- *매개변수 활용 차원변경하며 매출보기*    
1. 데이터패널에서 **'매개 변수 만들기'** - **'이름 : 차원선택하기, 데이터유형 : 문자열, 허용가능한값 : 목록'** - 값에 **'국가', '고객', '세그먼트'** 추가  
<img width="421" alt="image" src="https://github.com/Choe-minsung/TIL/assets/145301343/95721398-326d-4d06-9e2a-fed922955472">  

2. 생성 된 매개변수 우클릭 후 **'매개변수표시'**  
3. 데이터패널에서 **'계산된 필드 만들기'** - **필드명 : '차원선택', 계산식 :**
```
CASE [차원선택하기]
WHEN '국가' THEN [국가/지역]
WHEN '고객' THEN [고객 이름]
WHEN '세그먼트' THEN [세그먼트]
END
```
4. 만든 계산된 필드 (차원선택)을 '행'에 드랍, '열'에 (매출) 드랍 - 시트제목 더블클릭 기존제목 모두 지우기 - **'삽입'** 탭에 **'매개변수.차원선택하기'** 클릭 - 바뀌는 차원 눈에 띄도록 색상변경 - **'<매개변수.차원선택하기>에 따른 매출'** 로 제목 완성  
<img width="390" alt="image" src="https://github.com/Choe-minsung/TIL/assets/145301343/e2f6833e-3b9e-4231-bdeb-c82fdd6aeadc">  

5. 차원 바꿔가며 시트 확인  
<img width="1116" alt="image" src="https://github.com/Choe-minsung/TIL/assets/145301343/7348f268-45d1-4276-84cf-4a45e40cd964">  

- *매개변수 활용 차원변경하며 <매개변수> 별 <매개변수> 보기*    
1. 데이터패널에서 **'매개 변수 만들기'** - **'이름 : 측정값 선택하기, 데이터유형 : 문자열, 허용가능한값 : 목록'** - 값에 **'매출', '수량', '수익'** 추가  
2. 생성 된 매개변수 우클릭 후 **'매개변수표시'**    
3. 데이터패널에서 **'계산된 필드 만들기'** - **필드명 : '측정값 선택', 계산식 :**  
```
CASE [측정값 선택하기]
WHEN '매출' THEN SUM([매출])
WHEN '수량' THEN SUM([수량])
WHEN '수익' THEN SUM([수익])
END
```
4. 만든 계산된 필드 (측정값 선택)을 '열'에 드랍 - 시트제목 **'삽입'** 탭에 **'매개변수.측정값 선택하기'** 클릭 - 바뀌는 차원 눈에 띄도록 색상변경 - **'<매개변수.차원선택하기>에 따른 <매개변수.측정값 선택하기>'** 로 제목 완성  
<img width="1120" alt="image" src="https://github.com/Choe-minsung/TIL/assets/145301343/c16ac1d9-16d2-43ce-a50f-9a316fbb7357">  
